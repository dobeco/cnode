webpackJsonp([5],{J4Wv:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Dd8w"),n=e.n(a),c=e("7t+N"),r=e.n(c),i=e("NYxO"),o=e("fdFc"),u={name:"message",components:{vHeader:e("UzLt").a},data:function(){return{tab:["未读消息","已读消息"],currentIndex:0,message:[]}},computed:n()({},Object(i.b)(["user"])),created:function(){this.getLastTime=o.a,this.getMessages()},methods:{getMessages:function(){var s=this,t="https://cnodejs.org/api/v1/messages?accesstoken="+this.user.accessToken+"&mdrender=true";r.a.get(t).then(function(t){t.success&&(s.message=[t.data.hasnot_read_messages,t.data.has_read_messages])})},switchTab:function(s){this.currentIndex=s},markOne:function(s){var t="https://cnodejs.org/api/v1/message/mark_one/"+s.id;r.a.post(t,{accesstoken:this.user.accessToken}).then(function(t){t.success&&(s.has_read=!0)})},markAll:function(){var s=this;r.a.post("https://cnodejs.org/api/v1/message/mark_all",{accesstoken:this.user.accessToken}).then(function(t){t.success&&s.message[0].forEach(function(s){s.has_read=!0})})}}},l={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"message"},[e("v-header",{attrs:{head:"消息"}}),s._v(" "),e("ul",{staticClass:"tab"},s._l(s.tab,function(t,a){return e("li",{class:{current:s.currentIndex===a},on:{click:function(t){s.switchTab(a)}}},[s._v(s._s(t)+"\n    ")])})),s._v(" "),s.message.length?[s.message[s.currentIndex].length?e("ul",{staticClass:"message-list"},[0===s.currentIndex&&s.message[0].length?e("li",[e("button",{staticClass:"mark",on:{click:s.markAll}},[s._v("全部标记为已读")])]):s._e(),s._v(" "),s._l(s.message[s.currentIndex],function(t){return e("li",[e("div",{staticClass:"base"},[e("router-link",{attrs:{to:"/user/"+t.author.loginname}},[e("img",{staticClass:"avatar",attrs:{src:t.author.avatar_url,width:"40",height:"40"}})]),s._v(" "),e("div",{staticClass:"center"},[e("span",{staticClass:"name"},[s._v(s._s(t.author.loginname))]),s._v(" "),t.has_read?s._e():e("button",{staticClass:"mark",on:{click:function(e){s.markOne(t)}}},[s._v("标记为已读")])]),s._v(" "),e("time",[s._v(s._s(s.getLastTime(t.reply.create_at)))])],1),s._v(" "),e("div",{staticClass:"markdown-body content",domProps:{innerHTML:s._s(t.reply.content)}}),s._v(" "),e("router-link",{attrs:{to:"/topic/"+t.topic.id}},[e("h2",{staticClass:"title"},[s._v(s._s(t.topic.title))])])],1)})],2):e("div",{staticClass:"no-data"},[e("i",{staticClass:"icon-no-data"}),s._v(" "),e("p",[s._v("暂无消息")])])]:s._e()],2)},staticRenderFns:[]};var d=e("VU/8")(u,l,!1,function(s){e("XyN8")},null,null);t.default=d.exports},XyN8:function(s,t){}});
//# sourceMappingURL=5.bf222797445a2ad514af.js.map